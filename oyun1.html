<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bayrak Tahmin Oyunu</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color-light: #f0f4f8;
      --bg-color-dark: #1a202c;
      --card-bg-light: #ffffff;
      --card-bg-dark: #2d3748;
      --text-color-light: #2d3748;
      --text-color-dark: #e2e8f0;
      --border-color-light: #cbd5e0;
      --border-color-dark: #4a5568;
      --neon-red: #ff073a;
      --option-bg-light: #d0eaff;
      --option-bg-dark: #4a5568;
      --option-border-light: #0077cc;
      --option-border-dark: #2c5282;
      --option-hover-light: #a6d4ff;
      --option-hover-dark: #636d80;
    }
    body {
      font-family: 'Inter', sans-serif;
      display: flex;
      background: var(--bg-color-light);
      color: var(--text-color-light);
      transition: background-color 0.3s, color 0.3s;
      margin: 0;
      min-height: 100vh;
      box-sizing: border-box;
      flex-direction: column;
    }
    .dark-mode {
      background: var(--bg-color-dark);
      color: var(--text-color-dark);
    }
    #main-container {
      display: flex;
      flex: 1;
      flex-direction: row;
    }
    #sidebar {
      width: 300px;
      padding: 20px;
      background-color: var(--card-bg-light);
      border-right: 2px solid var(--border-color-light);
      font-size: 16px;
      position: relative;
      transition: background-color 0.3s, border-color 0.3s;
      display: flex;
      flex-direction: column;
    }
    .dark-mode #sidebar {
      background-color: var(--card-bg-dark);
      border-color: var(--border-color-dark);
    }
    #sidebar-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    #logo {
      font-family: 'Inter', sans-serif;
      font-weight: 700;
      font-size: 32px;
      color: var(--neon-red);
      text-shadow: 0 0 5px var(--neon-red), 0 0 10px var(--neon-red), 0 0 20px var(--neon-red);
      animation: neon-glow 1.5s ease-in-out infinite alternate;
      user-select: none;
    }
    @keyframes neon-glow {
      from { text-shadow: 0 0 5px var(--neon-red), 0 0 10px var(--neon-red), 0 0 15px var(--neon-red); }
      to { text-shadow: 0 0 7px var(--neon-red), 0 0 14px var(--neon-red), 0 0 21px var(--neon-red); }
    }
    .switch-container {
      display: flex;
      align-items: center;
    }
    .theme-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    .theme-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #2196F3;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    #game {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      text-align: center;
      min-height: 100%;
      box-sizing: border-box;
    }
    #topbar {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      margin-bottom: 20px;
    }
    #topbar span {
      font-size: 1.2em;
      font-weight: bold;
      margin: 0 10px;
    }
    #difficulty, #game-over {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      box-sizing: border-box;
      width: 100%;
    }
    #difficulty h1, #difficulty h2 {
      margin-bottom: 15px;
    }
    #difficulty button {
      padding: 15px 30px;
      font-size: 1.2em;
      margin: 10px;
      border-radius: 10px;
      background-color: #0077cc;
      color: white;
      border: none;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s;
    }
    #difficulty button:hover {
      background-color: #005f99;
      transform: translateY(-2px);
    }
    #flag {
      width: 320px;
      height: 180px;
      margin: 20px auto;
      border: 2px solid var(--border-color-light);
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: border-color 0.3s, box-shadow 0.3s;
    }
    .dark-mode #flag {
      border-color: var(--border-color-dark);
    }
    #options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 600px;
      margin-top: 20px;
    }
    .option {
      display: inline-block;
      margin: 10px;
      padding: 12px 24px;
      background-color: var(--option-bg-light);
      border: 1px solid var(--option-border-light);
      cursor: pointer;
      border-radius: 10px;
      transition: background-color 0.2s, transform 0.2s;
      user-select: none;
      font-weight: 500;
    }
    .dark-mode .option {
      background-color: var(--option-bg-dark);
      border-color: var(--option-border-dark);
    }
    .option:hover {
      background-color: var(--option-hover-light);
      transform: translateY(-2px);
    }
    .dark-mode .option:hover {
      background-color: var(--option-hover-dark);
    }
    #result {
      margin-top: 15px;
      font-weight: bold;
      font-size: 1.1em;
      transition: color 0.3s;
    }
    #result.correct { color: #28a745; }
    #result.incorrect { color: var(--neon-red); }
    .cat-table {
      font-size: 16px;
      margin-top: 20px;
      flex-grow: 1;
    }
    .cat-table h3 {
      margin-bottom: 5px;
      text-align: center;
      font-size: 1.2em;
    }
    .cat-table p {
      margin: 5px 0;
      padding: 4px 0;
    }
    .heart {
      color: var(--neon-red);
      font-size: 1.5em;
      margin-right: 5px;
    }
    #language-selector {
      position: absolute;
      bottom: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
    }
    .lang-flag {
      width: 40px;
      height: 24px;
      border: 1px solid var(--border-color-light);
      border-radius: 4px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .dark-mode .lang-flag {
      border-color: var(--border-color-dark);
    }
    .lang-flag:hover {
      transform: scale(1.1);
    }
    #game-over {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 100;
      text-align: center;
    }
    #game-over-content {
      background: var(--card-bg-light);
      padding: 40px;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      color: var(--text-color-light);
      transition: background-color 0.3s, color 0.3s;
    }
    .dark-mode #game-over-content {
      background: var(--card-bg-dark);
      color: var(--text-color-dark);
    }
    #game-over h2 {
      font-size: 2.5em;
      margin-bottom: 10px;
    }
    #game-over p {
      font-size: 1.5em;
      margin: 5px 0;
    }
    #game-over button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1.2em;
      border-radius: 8px;
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    #game-over button:hover {
      background-color: #218838;
    }

    .settings-group {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .settings-group label {
      font-weight: bold;
    }
    .settings-group input[type="range"] {
      width: 100%;
      -webkit-appearance: none;
      height: 8px;
      border-radius: 5px;
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      transition: opacity .2s;
    }
    .settings-group input[type="range"]:hover {
      opacity: 1;
    }
    .settings-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #0077cc;
      cursor: pointer;
    }
    .settings-group input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #0077cc;
      cursor: pointer;
    }
    .exit-btn {
      padding: 10px;
      margin-top: 20px;
      border-radius: 8px;
      background-color: var(--neon-red);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.2s;
    }
    .exit-btn:hover {
      background-color: #c00028;
    }

    @media (max-width: 768px) {
      #main-container {
        flex-direction: column;
      }
      #sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 2px solid var(--border-color-light);
        padding: 10px 20px;
      }
      .dark-mode #sidebar {
        border-color: var(--border-color-dark);
      }
      #sidebar-top {
        margin-bottom: 10px;
      }
      #logo {
        font-size: 24px;
      }
      #difficulty, #game {
        min-height: auto;
      }
      #difficulty h1 {
        font-size: 1.5em;
      }
      #difficulty h2 {
        font-size: 1.2em;
      }
      #difficulty button {
        padding: 10px 20px;
        font-size: 1em;
      }
      #flag {
        width: 200px;
        height: 112.5px;
      }
      #options {
        flex-direction: column;
        width: 90%;
      }
      .option {
        width: 100%;
        margin: 5px 0;
      }
      #language-selector {
        position: static;
        margin-top: 20px;
        justify-content: center;
      }
    }
  </style>
</head>
<body>

<div id="difficulty">
  <h1>Bayrak Tahmin Oyunu</h1>
  <h2 id="difficulty-title">Seviye Se√ßin:</h2>
  <button id="easy-btn" onclick="startGame('easy')">Kolay</button>
  <button id="normal-btn" onclick="startGame('normal')">Normal</button>
  <button id="hard-btn" onclick="startGame('hard')">Zor</button>
  <button id="insane-btn" onclick="startGame('insane')">Efsane</button>
</div>

<div id="main-container" style="display: none;">
  <div id="sidebar">
    <div id="sidebar-top">
      <div id="logo">MSZ</div>
      <label class="switch-container">
        <span id="theme-text">Aydƒ±nlƒ±k</span>
        <label class="theme-switch">
          <input type="checkbox" id="theme-toggle">
          <span class="slider"></span>
        </label>
      </label>
    </div>
    <div><strong id="rank-label">Rank:</strong> <span id="category">üïπÔ∏è Acemi</span></div>
    <div><strong id="score-label">Puan:</strong> <span id="scoreDisplay">0</span></div>
    <div><strong id="timer-label">S√ºre:</strong> <span id="timer">03:00</span></div>
    <div class="cat-table">
      <h3 id="rank-info-title">üèÜ Rank Bilgileri</h3>
      <p>100+ <span id="rank-100">ü•â Bronz</span></p>
      <p>200+ <span id="rank-200">üí† Platin</span></p>
      <p>300+ <span id="rank-300">üüß Altƒ±n</span></p>
      <p>350+ <span id="rank-350">üëë Ta√ß</span></p>
      <p>500+ <span id="rank-500">üíé Elmas</span></p>
      <p>1000+ <span id="rank-1000">üü• Fatih</span></p>
    </div>
    <div class="settings-group">
      <label for="delay-slider" id="delay-label">Ge√ßi≈ü S√ºresi: <span id="delay-value">1.0</span>s</label>
      <input type="range" id="delay-slider" min="0.1" max="2" value="1" step="0.1">
    </div>
    <button id="exit-btn" class="exit-btn" onclick="exitGame()"></button>
  </div>

  <div id="game">
    <div id="topbar">
      <div id="game-title-container">
        <h1 id="game-title">Bayrak Tahmin Oyunu</h1>
      </div>
    </div>
    <img id="flag" src="" alt="Bayrak">
    <div id="options"></div>
    <p id="result"></p>
  </div>
</div>

<div id="language-selector">
  <img src="https://flagcdn.com/w40/tr.png" class="lang-flag" onclick="setLanguage('tr')" alt="T√ºrk√ße">
  <img src="https://flagcdn.com/w40/gb.png" class="lang-flag" onclick="setLanguage('en')" alt="English">
</div>

<div id="game-over">
  <div id="game-over-content">
    <h2 id="game-over-title"></h2>
    <p id="final-score"></p>
    <button id="play-again-btn" onclick="location.reload()"></button>
  </div>
</div>

<script>
  // Bayrak verilerini hem T√ºrk√ße hem de ƒ∞ngilizce isimlerle g√ºncelledim.
  const flags = [
    { country_tr: "Filistin", country_en: "Palestine", img: "https://flagcdn.com/w320/ps.png" },
    { country_tr: "T√ºrkiye", country_en: "T√ºrkiye", img: "https://flagcdn.com/w320/tr.png" },
    { country_tr: "Almanya", country_en: "Germany", img: "https://flagcdn.com/w320/de.png" },
    { country_tr: "Fransa", country_en: "France", img: "https://flagcdn.com/w320/fr.png" },
    { country_tr: "ƒ∞talya", country_en: "Italy", img: "https://flagcdn.com/w320/it.png" },
    { country_tr: "ƒ∞spanya", country_en: "Spain", img: "https://flagcdn.com/w320/es.png" },
    { country_tr: "Polonya", country_en: "Poland", img: "https://flagcdn.com/w320/pl.png" },
    { country_tr: "Bel√ßika", country_en: "Belgium", img: "https://flagcdn.com/w320/be.png" },
    { country_tr: "L√ºksemburg", country_en: "Luxembourg", img: "https://flagcdn.com/w320/lu.png" },
    { country_tr: "Portekiz", country_en: "Portugal", img: "https://flagcdn.com/w320/pt.png" },
    { country_tr: "Uruguay", country_en: "Uruguay", img: "https://flagcdn.com/w320/uy.png" },
    { country_tr: "ABD", country_en: "USA", img: "https://flagcdn.com/w320/us.png" },
    { country_tr: "Kanada", country_en: "Canada", img: "https://flagcdn.com/w320/ca.png" },
    { country_tr: "Meksika", country_en: "Mexico", img: "https://flagcdn.com/w320/mx.png" },
    { country_tr: "Brezilya", country_en: "Brazil", img: "https://flagcdn.com/w320/br.png" },
    { country_tr: "Arjantin", country_en: "Argentina", img: "https://flagcdn.com/w320/ar.png" },
    { country_tr: "≈ûili", country_en: "Chile", img: "https://flagcdn.com/w320/cl.png" },
    { country_tr: "Kolombiya", country_en: "Colombia", img: "https://flagcdn.com/w320/co.png" },
    { country_tr: "Peru", country_en: "Peru", img: "https://flagcdn.com/w320/pe.png" },
    { country_tr: "Hollanda", country_en: "Netherlands", img: "https://flagcdn.com/w320/nl.png" },
    { country_tr: "ƒ∞sve√ß", country_en: "Sweden", img: "https://flagcdn.com/w320/se.png" },
    { country_tr: "Norve√ß", country_en: "Norway", img: "https://flagcdn.com/w320/no.png" },
    { country_tr: "Finlandiya", country_en: "Finland", img: "https://flagcdn.com/w320/fi.png" },
    { country_tr: "Danimarka", country_en: "Denmark", img: "https://flagcdn.com/w320/dk.png" },
    { country_tr: "Yunanistan", country_en: "Greece", img: "https://flagcdn.com/w320/gr.png" },
    { country_tr: "Japonya", country_en: "Japan", img: "https://flagcdn.com/w320/jp.png" },
    { country_tr: "√áin", country_en: "China", img: "https://flagcdn.com/w320/cn.png" },
    { country_tr: "Hindistan", country_en: "India", img: "https://flagcdn.com/w320/in.png" },
    { country_tr: "Avustralya", country_en: "Australia", img: "https://flagcdn.com/w320/au.png" },
    { country_tr: "G√ºney Kore", country_en: "South Korea", img: "https://flagcdn.com/w320/kr.png" },
    { country_tr: "Rusya", country_en: "Russia", img: "https://flagcdn.com/w320/ru.png" },
    { country_tr: "Birle≈üik Krallƒ±k", country_en: "United Kingdom", img: "https://flagcdn.com/w320/gb.png" },
    { country_tr: "Mƒ±sƒ±r", country_en: "Egypt", img: "https://flagcdn.com/w320/eg.png" },
    { country_tr: "Suudi Arabistan", country_en: "Saudi Arabia", img: "https://flagcdn.com/w320/sa.png" },
    { country_tr: "Irak", country_en: "Iraq", img: "https://flagcdn.com/w320/iq.png" },
    { country_tr: "ƒ∞ran", country_en: "Iran", img: "https://flagcdn.com/w320/ir.png" },
    { country_tr: "Pakistan", country_en: "Pakistan", img: "https://flagcdn.com/w320/pk.png" },
    { country_tr: "Vietnam", country_en: "Vietnam", img: "https://flagcdn.com/w320/vn.png" },
    { country_tr: "Tayland", country_en: "Thailand", img: "https://flagcdn.com/w320/th.png" },
    { country_tr: "Ukrayna", country_en: "Ukraine", img: "https://flagcdn.com/w320/ua.png" },
    { country_tr: "ƒ∞rlanda", country_en: "Ireland", img: "https://flagcdn.com/w320/ie.png" },
    { country_tr: "ƒ∞zlanda", country_en: "Iceland", img: "https://flagcdn.com/w320/is.png" },
    { country_tr: "√áek Cumhuriyeti", country_en: "Czech Republic", img: "https://flagcdn.com/w320/cz.png" },
    { country_tr: "Macaristan", country_en: "Hungary", img: "https://flagcdn.com/w320/hu.png" },
  ];

  const translations = {
    tr: {
      title: "Bayrak Tahmin Oyunu",
      difficultyTitle: "Seviye Se√ßin:",
      easy: "Kolay",
      normal: "Normal",
      hard: "Zor",
      insane: "Efsane",
      rank: "Rank:",
      score: "Puan:",
      timer: "S√ºre:",
      rankInfoTitle: "üèÜ Rank Bilgileri",
      rank100: "ü•â Bronz",
      rank200: "üí† Platin",
      rank300: "üüß Altƒ±n",
      rank350: "üëë Ta√ß",
      rank500: "üíé Elmas",
      rank1000: "üü• Fatih",
      correct: "‚úÖ Doƒüru! +25",
      incorrect: "‚ùå Yanlƒ±≈ü! -15 | Doƒüru: ",
      gameOverTime: "üíî S√ºre Bitti! Kaybettin!",
      gameOverWin: "üéâ Tebrikler! Fatih oldun!",
      playAgain: "Tekrar Oyna",
      rookieRank: "üïπÔ∏è Acemi",
      lightTheme: "Aydƒ±nlƒ±k",
      darkTheme: "Karanlƒ±k",
      exit: "√áƒ±kƒ±≈ü",
      delay: "Ge√ßi≈ü S√ºresi:",
    },
    en: {
      title: "Flag Guessing Game",
      difficultyTitle: "Select Difficulty:",
      easy: "Easy",
      normal: "Normal",
      hard: "Hard",
      insane: "Insane",
      rank: "Rank:",
      score: "Score:",
      timer: "Time:",
      rankInfoTitle: "üèÜ Rank Information",
      rank100: "ü•â Bronze",
      rank200: "üí† Platinum",
      rank300: "üüß Gold",
      rank350: "üëë Crown",
      rank500: "üíé Diamond",
      rank1000: "üü• Conqueror",
      correct: "‚úÖ Correct! +25",
      incorrect: "‚ùå Incorrect! -15 | Correct: ",
      gameOverTime: "üíî Time's Up! You Lost!",
      gameOverWin: "üéâ Congratulations! You are a Conqueror!",
      playAgain: "Play Again",
      rookieRank: "üïπÔ∏è Rookie",
      lightTheme: "Light",
      darkTheme: "Dark",
      exit: "Exit",
      delay: "Transition Delay:",
    }
  };

  let currentLang = 'tr';
  let currentFlag;
  let score = 0;
  let timeLeft;
  let timerInterval;
  let answerDelay = 1.0;

  function setLanguage(lang) {
    currentLang = lang;
    const t = translations[currentLang];
    document.getElementById("difficulty-title").textContent = t.difficultyTitle;
    document.getElementById("easy-btn").textContent = t.easy;
    document.getElementById("normal-btn").textContent = t.normal;
    document.getElementById("hard-btn").textContent = t.hard;
    document.getElementById("insane-btn").textContent = t.insane;
    document.getElementById("rank-label").textContent = t.rank;
    document.getElementById("score-label").textContent = t.score;
    document.getElementById("timer-label").textContent = t.timer;
    document.getElementById("rank-info-title").textContent = t.rankInfoTitle;
    document.getElementById("rank-100").textContent = t.rank100;
    document.getElementById("rank-200").textContent = t.rank200;
    document.getElementById("rank-300").textContent = t.rank300;
    document.getElementById("rank-350").textContent = t.rank350;
    document.getElementById("rank-500").textContent = t.rank500;
    document.getElementById("rank-1000").textContent = t.rank1000;
    document.getElementById("game-title").textContent = t.title;
    document.getElementById("theme-text").textContent = document.body.classList.contains('dark-mode') ? t.darkTheme : t.lightTheme;
    document.getElementById("exit-btn").textContent = t.exit;
    document.getElementById("delay-label").textContent = `${t.delay} ${answerDelay.toFixed(1)}s`;
    updateCategory();
  }

  const themeToggle = document.getElementById('theme-toggle');
  themeToggle.addEventListener('change', function() {
    document.body.classList.toggle('dark-mode');
    const t = translations[currentLang];
    document.getElementById("theme-text").textContent = this.checked ? t.darkTheme : t.lightTheme;
  });

  const delaySlider = document.getElementById('delay-slider');
  delaySlider.addEventListener('input', function() {
    answerDelay = parseFloat(this.value);
    const t = translations[currentLang];
    document.getElementById("delay-value").textContent = this.value;
  });

  function updateCategory() {
    const t = translations[currentLang];
    const categoryEl = document.getElementById("category");
    if (score >= 1000) categoryEl.textContent = t.rank1000;
    else if (score >= 500) categoryEl.textContent = t.rank500;
    else if (score >= 350) categoryEl.textContent = t.rank350;
    else if (score >= 300) categoryEl.textContent = t.rank300;
    else if (score >= 200) categoryEl.textContent = t.rank200;
    else if (score >= 100) categoryEl.textContent = t.rank100;
    else categoryEl.textContent = t.rookieRank;
  }

  function updateScoreDisplay() {
    document.getElementById("scoreDisplay").textContent = score;
  }

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function newQuestion() {
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";

    const randomIndex = Math.floor(Math.random() * flags.length);
    currentFlag = flags[randomIndex];
    document.getElementById("flag").src = currentFlag.img;

    const countryKey = `country_${currentLang}`;
    const options = [currentFlag[countryKey]];
    while (options.length < 4) {
      const rand = flags[Math.floor(Math.random() * flags.length)][countryKey];
      if (!options.includes(rand)) options.push(rand);
    }

    shuffle(options).forEach(option => {
      const btn = document.createElement("div");
      btn.className = "option";
      btn.textContent = option;
      btn.onclick = () => checkAnswer(option);
      optionsDiv.appendChild(btn);
    });
  }

  function checkAnswer(answer) {
    const t = translations[currentLang];
    const resultEl = document.getElementById("result");
    
    // Doƒüru cevap i√ßin hangi anahtarƒ± kullanacaƒüƒ±mƒ±zƒ± belirle
    const countryKey = `country_${currentLang}`;
    const correctAnswer = currentFlag[countryKey];

    if (answer === correctAnswer) {
      score += 25;
      resultEl.textContent = t.correct;
      resultEl.className = "correct";
    } else {
      score -= 15;
      resultEl.textContent = t.incorrect + correctAnswer;
      resultEl.className = "incorrect";
    }

    updateScoreDisplay();
    updateCategory();
    
    if (score >= 1000) {
      endGame(t.gameOverWin);
      return;
    }

    setTimeout(() => {
      resultEl.textContent = "";
      newQuestion();
    }, answerDelay * 1000);
  }

  function updateTimer() {
    const t = translations[currentLang];
    let minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    document.getElementById("timer").textContent =
      `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    if (timeLeft <= 0) {
      clearInterval(timerInterval);
      if (score < 1000) {
        endGame(t.gameOverTime);
      } else {
        endGame(t.gameOverWin);
      }
    } else {
      timeLeft--;
    }
  }

  function endGame(message) {
    const t = translations[currentLang];
    clearInterval(timerInterval);
    document.getElementById("game-over-title").textContent = message;
    document.getElementById("final-score").textContent = `${t.score} ${score}`;
    document.getElementById("play-again-btn").textContent = t.playAgain;
    document.getElementById("game-over").style.display = "flex";
  }

  function startGame(selectedDifficulty) {
    let timeLeftInSeconds = 0;
    if (selectedDifficulty === "easy") timeLeftInSeconds = 300;
    else if (selectedDifficulty === "normal") timeLeftInSeconds = 240;
    else if (selectedDifficulty === "hard") timeLeftInSeconds = 120;
    else if (selectedDifficulty === "insane") timeLeftInSeconds = 60;

    timeLeft = timeLeftInSeconds;
    
    document.getElementById("difficulty").style.display = "none";
    document.getElementById("main-container").style.display = "flex";
    document.getElementById("language-selector").style.display = "none";
    
    const t = translations[currentLang];
    document.getElementById("exit-btn").textContent = t.exit;
    document.getElementById("delay-label").textContent = `${t.delay} ${answerDelay.toFixed(1)}s`;

    score = 0;
    updateCategory();
    updateScoreDisplay();
    newQuestion();
    updateTimer();

    timerInterval = setInterval(updateTimer, 1000);
  }
  
  function exitGame() {
    clearInterval(timerInterval);
    document.getElementById("main-container").style.display = "none";
    document.getElementById("difficulty").style.display = "flex";
    document.getElementById("language-selector").style.display = "flex";
  }
</script>

</body>
</html>
